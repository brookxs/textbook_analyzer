 3.6 Calculating TF-IDF Weighting  Following the careful empirical investigation of Salton and Buckley [Salton and Buckley, 1988d; Salton and Buckley, 1990] and many others since [Harman, 1992a], we will concentrate on the TF-IDF weighting, which multiplies the raw term frequency (TF) of a term in a document  by the term's inverse document frequency (IDF) weight:  idfk = log (^^j                      (3.40)  = fkd  where fkd is the frequency with which keyword fc occurs in document d, NDoc Is the total number of documents in the corpus, and D is the number of documents containing keyword k.  Due to the wide variety observed in users' query patterns, methods for weighting queries vary more, primarily depending on the length of the query. We will consider two weighting methods, especially designed for ushorf and "long" queries. Short queries (of as few as one or two terms; cf. [Silverstein et al, 1999]) seem typical of those issued by Web search engine users. For these, we can assume multiple occurrences of the same keyword will be rare, and we ignore length normalization. This WEIGHTING AND MATCHING AGAINST INDICES       97  leaves us with simply the term's inverse frequency weight:  tyk                                 (3-42)  Long queries are often generated indirectly, as the result of relevance feedback from the users in response to prior retrievals. The long query corresponds to a particular document that the users like; searching for others like a known target is called query-by-example. By symmetry, it makes sense to use the same weighting of terms in this query-cum-document as we used for documents (Equation 3.40):  Wkq^Qn    =  fkq idfy                                    (3.43)  Notice that once the lengths of the q and d vectors in the denominator of Equation 3.39 are known, the computation of Sim requires a simple sum of products over all terms shared by query and document. Because both these lengths can be computed independently, it makes sense to compute them first.^                                                                              Implementation:  In fact, the document length Len(d) can be computed before any    Storing  ,        ,                                                                             document  query activity takes place:                                                                       lenglhs  (3.44)  With these definitions in place, we can begin to design an algorithm for computing similarity.   