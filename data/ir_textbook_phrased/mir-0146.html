8.5.3 boyer-moore family bm algorithms are based on the fact that the check inside the window can proceed backwards . when a match or mismatch is determined , a suffix of the pattern has been compared and found equal to the text in the window . this can be used in a way very similar to the next table of kmp , i.e. compute for every pattern position j the next-to-last occurrence of pj . . m inside p . this is called the kmatch heuristic / this is combined with what is called the ` occurrence heuristic ' it states that the text character that produced the mismatch (if a mismatch occurred) has to be aligned with the same character in the pattern after the shift . the heuristic which gives the longest shift is selected . for instance , assume that ` abracadabra '' is searched in a text which starts with kabracababra / after matching the suffix kabra '' the underlined text character ` b1 will cause a mismatch . the match heuristic states that since `` abra '' was matched a shift of 7 is safe . the occurrence heuristic states that since the underlined * b * must match the pattern , a shift of 5 is safe . hence , the pattern is 212 indexing and searching figure 8.16 bm-algorithm searching ` abracadabra . ' squared areas show the comparisons performed . grayed areas have already been compared (but the algorithm compares them again) . the dashed box shows the match heuristic , which was not chosen . shifted by 7 . see figure 8.16 . the preprocessing time and space of this algorithm is o (m + a) . its search-time is o (nlog (m) / ra) on average , which is ` sublinear1 in the sense that not all characters are inspected . on the other hand , its worst-case is 0 {mn) (unlike kmp , the old suffix information is not kept to avoid further comparisons) . further simplifications of the bm-algorithm lead to some of the fastest algorithms on average . the simplified bm-algorithm uses only the occurrence heuristic . this obtains almost the same shifts in practice . the bm-horspool (bmh) algorithm does the same , but it notices that it is not important any more that the check proceeds backwards , and uses the occurrence heuristic on the last character of the window instead of the one that caused the mismatch . this gives longer shifts on average . finally , the bm-sunday (bms) algorithm modifies bmh by using the character following the last one , which improves the shift especially on short patterns . the commentz-walter algorithm is an extension of bm to multipattern search . it builds a trie on the reversed patterns , and instead of a backward window check , it enters into the trie with the window characters read backwards . a shift function is computed by a natural extension of bm . in general this algorithm improves over aho-corasick for not too many patterns .