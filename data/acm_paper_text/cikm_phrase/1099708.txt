compact reachability labeling for graph-structured-data testing reachability between nodes in a graph is a well-known problem with many important applications , including knowledge-representation , program-analysis , and more recently , biological and ontology databases inferencing as well as xml-query-processing . various approaches have been proposed to encode graph-reachability information using node-labeling schemes , but most existing schemes only work well for specific types of graphs . in this paper , we propose a novel approach , hlss (hierarchical-labeling of sub-structures) , which identifies different types of substructures within a graph and encodes them using techniques suitable to the characteristics of each of them . we implement hlss with an efficient two-phase algorithm , where the first phase identifies and encodes strongly-connected-components as well as tree substructures , and the second phase encodes the remaining reachability relationships by compressing dense rectangular submatrices in the transitive-closure matrix . for the important subproblem of finding densest submatrices , we demonstrate the hardness of the problem and propose several practical algorithms . experiments show that hlss handles different types of graphs well , while existing approaches fall prey to graphs with substructures they are not designed to handle .