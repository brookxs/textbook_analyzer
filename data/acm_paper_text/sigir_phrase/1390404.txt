optimizing relevance and revenue in ad-search : a query-substitution approach the primary business-model behind web-search is based on textual advertising , where contextually relevant ads are displayed alongside search-results . we address the problem of selecting these ads so that they are both relevant to the queries and profitable to the search-engine , showing that optimizing ad relevance and revenue is not equivalent . selecting the best ads that satisfy these constraints also naturally incurs high computational costs , and time-constraints can lead to reduced relevance and profitability . we propose a novel two-stage approach , which conducts most of the analysis ahead of time . an offine preprocessing phase leverages additional knowledge that is impractical to use in real-time , and rewrites frequent-queries in a way that subsequently facilitates fast and accurate online-matching . empirical-evaluation shows that our method optimized for relevance matches a state-of-the-art method while improving expected revenue . when optimizing for revenue , we see even more substantial improvements in expected revenue .